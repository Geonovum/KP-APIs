
# ADR-HTTP Message and payload encryption



<aside class="note" title="Status">
        <p>This module is under development</p>
</aside>


## Introduction

This module specifies the use of JWE for HTTP message and payload encryption.

## JWE encryption

## Cryptographic Algorithms

Following ENISA's Good Practises in Cryptography â€“ Primitives and Schemes [[ENISA-CRYPTO-2020]], the following algorithms found in [[RFC7518]] are selected for this profile, to be used in the following form:
* The ECDSA Algorithm with SHA-256 and P-256 Curve MUST be supported, with a key length of at least 256 bits. The value "ES256" for the alg parameter MUST be used in this case as defined in [[RFC7518]].
* The EdDSA Algorithm [[RFC8032]] using one of the curves defined in [[RFC7748]] SHOULD be supported and is RECOMMENDED for use, with a key length of at least 256 bits. The value "EdDSA" for the alg parameter MUST be used in this case and the curve shall be encoded in the crv parameter as defined in [[RFC8037]].

## Payload encryption

Payload encryption ensures the confidentiality of the payload part of the message.  When payload encrytion is considered, JWE MUST be applied with the following restrictions:
* a 
* b

# Encryption in combination with signing

```mermaid
flowchart TD
    Request--JSON(payload)-->SignA
    SignA--JWE(JWS(JSON(payload)))-->SignB
    SignB--JSON(payload)-->Proc
    Proc--JSON(payload)-->SignC
    SignC--JWE(JWS(JSON(payload)))-->SignD
    SignD--JSON(payload)-->Response
    
    
    direction TB
    subgraph Service Provider
    direction TB
    SignB(Decrypt with provider private key 
    -----------------------
    Verify with Requester public key)
    Proc(Process Request)
    SignC(Sign with Provider private key 
    -----------------------
    Encrypt with Requester public key)    
    
    end
    subgraph Service Requester
    direction TB
    Request:::sc
    SignA(Sign with Requester private key 
    -----------------------
    Encrypt with Provider public key)
    SignD(Decrypt with provider private key 
    -----------------------
    Verify with Requester public key)
    classDef sc fill:#f96
    Response:::sc
    end
```



